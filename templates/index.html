<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Einsatzplan - SLT</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename = 'styles.css') }}" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,700;1,100&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet" />
  </head>
  {% block title %}
    <body>
      <head>
        <p id="week-output"></p>
      </head>

      <main>
        <div class="top-container">
          <div id="login-frame">
            <form id="login-form" method="POST" action="{{ url_for('login') }}">
              {{ form.hidden_tag() }}
              {{ form.csrf_token }}
              <label for="username">Username:</label>
              {{ form.username }}
              <br /><br />
              <label for="password">Password:</label>
              {{ form.password }}
              <br /><br />
              <button type="submit" id="login-button">Login</button>
            </form>
          </div>
          <div class="logo">
            <img src="https://www.slt-technologies.com/images/main_header_left-slt.jpg" alt="" />
          </div>
        </div>

        {% block content %}
          <div id="main-frame">
            <h1>Einsatzplan</h1>
            <div class="tables-container">
              <table class="week-table">
                <thead>
                  <tr>
                    <th>P-Nr.</th>
                    <th>Name</th>
                    {% for date in weekDates1 %}
                      <th>{{ date }}</th>
                    {% endfor %}
                  </tr>
                </thead>
                <tbody>
                  {% if data %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong>Schlosser</strong>
                      </td>
                      {% for day in weekDays %}
                        <th colspan="1">{{ day }}</th>
                      {% endfor %}
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Schlosser' %}
                        <tr>
                          <td>{{ row[0] }}</td>
                          <td>{{ row[1] }}</td>
                          {% for date in weekDates1 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong>Dreher & Fräser</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Dreher & Fräser' %}
                        <tr>
                          <td>{{ row[0] }}</td>
                          <td>{{ row[1] }}</td>
                          {% for date in weekDates1 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong>Elektriker</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Elektriker' %}
                        <tr>
                          <td>{{ row[0] }}</td>
                          <td>{{ row[1] }}</td>
                          {% for date in weekDates1 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong>Freie Mitarbeiter</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Freie Mitarbeiter' %}
                        <tr>
                          <td>{{ row[0] }}</td>
                          <td>{{ row[1] }}</td>
                          {% for date in weekDates1 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong>Büro</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Büro' %}
                        <tr>
                          <td>{{ row[0] }}</td>
                          <td>{{ row[1] }}</td>
                          {% for date in weekDates1 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong>Hauswart</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Hauswart' %}
                        <tr>
                          <td>{{ row[0] }}</td>
                          <td>{{ row[1] }}</td>
                          {% for date in weekDates1 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <tr>
                      <td colspan="5">No data available</td>
                    </tr>
                  {% endif %}
                </tbody>
              </table>
              <table class="week-table">
                <thead>
                  <tr>
                    <th id="m-pc-row">P-Nr.</th>
                    <th id="m-pc-row">Name</th>
                    {% for date in weekDates2 %}
                      <th>{{ date }}</th>
                    {% endfor %}
                  </tr>
                </thead>
                <tbody>
                  {% if data %}
                    <tr>
                      <td colspan="0" style="border: 0; display: none;">
                        <strong style="color: rgb(233, 240, 232);">Schlosser</strong>
                      </td>
                      {% for day in weekDays %}
                        <th colspan="1">{{ day }}</th>
                      {% endfor %}
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Schlosser' %}
                        <tr>
                          <td id="m-pc-row">{{ row[0] }}</td>
                          <td id="m-pc-row">{{ row[1] }}</td>
                          {% for date in weekDates2 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong style="color: rgb(233, 240, 232);">Dreher & Fräser</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Dreher & Fräser' %}
                        <tr>
                          <td id="m-pc-row">{{ row[0] }}</td>
                          <td id="m-pc-row">{{ row[1] }}</td>
                          {% for date in weekDates2 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong style="color: rgb(233, 240, 232);">Elektriker</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Elektriker' %}
                        <tr>
                          <td id="m-pc-row">{{ row[0] }}</td>
                          <td id="m-pc-row">{{ row[1] }}</td>
                          {% for date in weekDates2 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong style="color: rgb(233, 240, 232);">Freie Mitarbeiter</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Freie Mitarbeiter' %}
                        <tr>
                          <td id="m-pc-row">{{ row[0] }}</td>
                          <td id="m-pc-row">{{ row[1] }}</td>
                          {% for date in weekDates2 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong style="color: rgb(233, 240, 232);">Büro</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Büro' %}
                        <tr>
                          <td id="m-pc-row">{{ row[0] }}</td>
                          <td id="m-pc-row">{{ row[1] }}</td>
                          {% for date in weekDates2 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong style="color: rgb(233, 240, 232);">Hauswart</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Hauswart' %}
                        <tr>
                          <td id="m-pc-row">{{ row[0] }}</td>
                          <td id="m-pc-row">{{ row[1] }}</td>
                          {% for date in weekDates2 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <tr>
                      <td colspan="5">No data available</td>
                    </tr>
                  {% endif %}
                </tbody>
              </table>
              <table class="week-table">
                <thead>
                  <tr>
                    <th id="m-pc-row">P-Nr.</th>
                    <th id="m-pc-row">Name</th>
                    {% for date in weekDates3 %}
                      <th>{{ date }}</th>
                    {% endfor %}
                  </tr>
                </thead>
                <tbody>
                  {% if data %}
                    <tr>
                      <td colspan="0" style="border: 0; display: none;">
                        <strong style="color: rgb(233, 240, 232);">Schlosser</strong>
                      </td>
                      {% for day in weekDays %}
                        <th colspan="1">{{ day }}</th>
                      {% endfor %}
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Schlosser' %}
                        <tr>
                          <td id="m-pc-row">{{ row[0] }}</td>
                          <td id="m-pc-row">{{ row[1] }}</td>
                          {% for date in weekDates3 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong style="color: rgb(233, 240, 232);">Dreher & Fräser</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Dreher & Fräser' %}
                        <tr>
                          <td id="m-pc-row">{{ row[0] }}</td>
                          <td id="m-pc-row">{{ row[1] }}</td>
                          {% for date in weekDates3 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong style="color: rgb(233, 240, 232);">Elektriker</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Elektriker' %}
                        <tr>
                          <td id="m-pc-row">{{ row[0] }}</td>
                          <td id="m-pc-row">{{ row[1] }}</td>
                          {% for date in weekDates3 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong style="color: rgb(233, 240, 232);">Freie Mitarbeiter</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Freie Mitarbeiter' %}
                        <tr>
                          <td id="m-pc-row">{{ row[0] }}</td>
                          <td id="m-pc-row">{{ row[1] }}</td>
                          {% for date in weekDates3 %}
                            <td id="t-a-field">
                              {% set assignment_found = false %}
                              {% for assignment in assignment_table_data %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div>
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[1] == 99 %}

                                        {% else %}
                                          {{ car[1] }}
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    <br />
                                    {% if assignment[6] != 'no' and assignment[6] != 'null' %}
                                      {{ assignment[6] }}
                                    {% endif %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    <br />
                                    {{ assignment[9] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong style="color: rgb(233, 240, 232);">Büro</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Büro' %}
                        <tr>
                          <td id="m-pc-row">{{ row[0] }}</td>
                          <td id="m-pc-row">{{ row[1] }}</td>
                          {% for date in weekDates3 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                    <tr>
                      <td colspan="2" style="border:0;">
                        <strong style="color: rgb(233, 240, 232);">Hauswart</strong>
                      </td>
                    </tr>
                    {% for row in data %}
                      {% if row[3] == 'Hauswart' %}
                        <tr>
                          <td id="m-pc-row">{{ row[0] }}</td>
                          <td id="m-pc-row">{{ row[1] }}</td>
                          {% for date in weekDates3 %}
                            <td class="assignment-cell" id="t-a-field">
                              {% for assignment in assignment_table_data %}
                                {% set assignment_found = false %}
                                {% if row[0] == assignment[1] and assignment[4] <= date <= assignment[5] %}
                                  {% set assignment_found = true %}
                                  <div data-assignment-id="{{ assignment[0] }}">
                                    {{ assignment[3] }}
                                    <br />
                                    {% for car in car_table_data %}
                                      {% if car[0] == assignment[2] %}
                                        {% if car[0] != 99 %}
                                          {{ car[1] }}
                                          <br />
                                        {% endif %}
                                      {% endif %}
                                    {% endfor %}
                                    {% if assignment[7] != 'no' and assignment[7] != 'null' %}
                                      {{ assignment[7] }}
                                    {% endif %}
                                    {% if assignment[8] != 'no' and assignment[8] != 'null' %}
                                      {{ assignment[8] }}
                                    {% endif %}
                                    {% if assignment[9] != 'no' and assignment[9] != 'null' %}
                                      {{ assignment[9] }}
                                    {% endif %}
                                    {{ assignment[10] }}
                                  </div>
                                {% endif %}
                              {% endfor %}
                              {% if not assignment_found %}
                                <!-- Create an empty td when no assignment is found -->
                              {% endif %}
                            </td>
                          {% endfor %}
                        </tr>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <tr>
                      <td colspan="5">No data available</td>
                    </tr>
                  {% endif %}
                </tbody>
              </table>
            </div>
            <br />

            {% if user_role == 'admin' %}
              <div id="assign-frame">
                {% block assign_frame %}
                  <div class="assign-m">
                    <h3>Einzelne Mitarbeiter zuweisen</h3>
                    <form id="assignForm" action="/assign_mitarbeiter" method="POST">
                      <label id="a">
                        Mitarbeiter:<select name="personal_nr" id="dd-m" required>
                          <option value="" disabled selected>Mitarbeiter</option>
                          {% for row in data %}
                            <option value="{{ row[0] }}">{{ row[0] }}: {{ row[1] }}</option>
                          {% endfor %}
                        </select>
                      </label>
                      <!-- Entweder auswählen oder in der Tabelle anklicken -->
                      <label>Von-Bis-Datum:<input type="text" id="date-select" name="datefilter" value="" required /></label>
                      <label>
                        Projekt:<select name="project_id" id="dd-p" required>
                          <option value="" disabled selected>Projekt</option>
                          {% for row in project_table_data %}
                            <option value="{{ row[0] }}">{{ row[0] }}: {{ row[1] }}</option>
                          {% endfor %}
                        </select>
                      </label>
                      <label>
                        Auto:<select name="car_id" id="dd-p">
                          <!-- Autos aus Datenbank auslesen -->
                          <option value="" disabled selected>Auto</option>
                          {% for row in car_table_data %}
                            {% if row[0] != 0 %}
                              <option value="{{ row[0] }}">{{ row[0] }}: {{ row[1] }}</option>
                            {% endif %}
                          {% endfor %}
                        </select>
                      </label>
                      <label>
                        Ort:<select name="ort" id="dd-l" required>
                          <option value="vO">Vor-Ort</option>
                          <option value="iF">In Firma</option>
                        </select>
                      </label>
                      <label>
                        Zusatz:<select name="extra1" id="dd-x">
                          <option value="" disabled selected>Weiteres..</option>
                          <option value="ST.">Stundenzettel</option>
                          <option value="H">Hotel</option>
                        </select>
                      </label>
                      <label>
                        <select name="extra2" id="dd-x">
                          <option value="" disabled selected>Weiteres..</option>
                          <option value="ST.">Stundenzettel</option>
                          <option value="H">Hotel</option>
                        </select>
                      </label>
                      <label>
                        <select name="extra3" id="dd-x">
                          <option value="" disabled selected>Weiteres..</option>
                          <option value="ST.">Stundenzettel</option>
                          <option value="H">Hotel</option>
                        </select>
                      </label>
                      <label>Hinweis:<textarea name="hinweis" id="hinweis" cols="30" rows="5"></textarea></label>
                      <br />
                      <button class="confirm">Bestätigen</button>
                    </form>
                  </div>
                  <div class="group-create">
                    <h3>Gruppe erstellen & zuweisen</h3>
                    <p>Wähle mehrere Mitarbeiter aus, um eine Gruppe zu erstellen.</p>
                    <!-- Vielleicht eine Mehrfachauswahl-Liste implementieren? -->
                    <p>Wähle eine Farbe für diese Gruppe und anschließend das Projekt sowie weitere "Eigenschaften".</p>
                  </div>

                  <div class="add-data">
                    <h3>Füge Daten zu der Datenbank hinzu.</h3>
                    <form action="/submit_m_add" method="POST">
                      <label>
                        Neuen Mitarbeiter:<br />
                        <input type="number" name="personal_nr" placeholder="Personal-Nr." />
                        <input type="text" name="vorname" placeholder="Vorname" />
                        <input type="text" name="nachname" placeholder="Nachname" />
                        <select name="bereich" id="">
                          <option value="" disabled selected>Bereich</option>
                          <option value="Schlosser">Schlosser</option>
                          <option value="Dreher & Fräser">Dreher & Fräser</option>
                          <option value="Elektriker">Elektriker</option>
                          <option value="Freie Mitarbeiter">Freie Mitarbeiter</option>
                          <option value="Büro">Büro</option>
                          <option value="Hauswart">Hauswart</option>
                        </select>
                      </label>
                      <button type="submit">Erstellen</button>
                    </form>
                    <br />
                    <label>Neuen Kunden:</label>
                    <form action="/submit_c_add" method="POST">
                      <input type="number" name="customer_id" placeholder="Kunden-Nr." />
                      <input type="text" name="customer_name" placeholder="Kunden-Name" />
                      <button type="submit">Erstellen</button>
                    </form>
                    <br />
                    <label>Neues Projekt:</label>
                    <br />
                    <form action="/submit_p_add" method="POST">
                      <input type="number" name="project_id" placeholder="Projekt-Nr." />
                      <input type="text" name="project_name" placeholder="Projekt-Name" />
                      <select name="customer_id" id="dd-c">
                        <option value="" disabled selected>Kunde</option>
                        {% for row in customer_table_data %}
                          <option value="{{ row[0] }}">{{ row[0] }}: {{ row[1] }}</option>
                        {% endfor %}
                      </select>
                      <button type="submit">Erstellen</button>
                    </form>
                    <label>Neues Auto:</label>
                    <br />
                    <form action="/submit_car_add" method="POST">
                      <input type="text" name="car_id" placeholder="Kennzeichen.." />
                      <button type="submit">Erstellen</button>
                    </form>
                    <br />
                  </div>
                  <div class="delete-data">
                    <h3>Lösche Daten aus der Datenbank.</h3>

                    <h4>Mitarbeiter löschen:</h4>
                    <form action="/submit_m_delete" method="POST">
                      <select name="personal_nr" id="">
                        <option value="" disabled selected>Auto</option>
                        {% for row in data %}
                          <option value="{{ row[0] }}">{{ row[0] }}: {{ row[1] }}</option>
                        {% endfor %}
                      </select>
                      <button type="submit">Löschen</button>
                    </form>

                    <br />
                    <h4>Kunden löschen:</h4>
                    <form action="/submit_c_delete" method="POST">
                      <select name="kunden-delete" id="">
                        <option value="" disabled selected>Kunde</option>
                        {% for row in customer_table_data %}
                          <option value="{{ row[0] }}">{{ row[0] }}: {{ row[1] }}</option>
                        {% endfor %}
                      </select>
                      <button type="submit">Löschen</button>
                    </form>

                    <h4>Auto löschen:</h4>
                    <form action="/submit_car_delete" method="POST">
                      <select name="car-delete" id="">
                        <option value="" disabled selected>Auto</option>
                        {% for row in car_table_data %}
                          <option value="{{ row[0] }}">{{ row[0] }}: {{ row[1] }}</option>
                        {% endfor %}
                      </select>
                      <button type="submit">Löschen</button>
                    </form>
                    <h4>Projekt löschen:</h4>
                    <form action="/submit_p_delete" method="POST">
                      <select name="project-delete" id="">
                        <option value="" disabled selected>Projekt</option>
                        {% for row in project_table_data %}
                          <option value="{{ row[0] }}">{{ row[0] }}: {{ row[1] }}</option>
                        {% endfor %}
                      </select>
                      <button type="submit">Löschen</button>
                    </form>
                  </div>
                {% endblock %}
              </div>
            {% endif %}
          </div>
        {% endblock %}
      </main>

      <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
      <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
      <script src="{{ url_for('static', filename = 'javascript.js') }}"></script>
      <script>
        document.addEventListener('DOMContentLoaded', function () {
          document.getElementById('login-form').addEventListener('submit', function (e) {
            e.preventDefault()
            var formData = new FormData(this)
            fetch('/login', {
              method: 'POST',
              body: formData
            })
              .then((response) => response.json())
              .then((data) => {
                console.log('Login Response:', data) // Log the response to the console
                if (data.status === 'success') {
                  console.log('User Role:', data.user_role) // Log the user role to the console
                  window.location.href = '/?user_role=' + (data.user_role || 'user')
                } else {
                  alert('Invalid username or password. Please try again.')
                }
              })
              .catch((error) => {
                console.error('Error:', error)
              })
          })
        })
        
        $(document).ready(function () {
          $('#date-range').daterangepicker({
            startDate: '2023-01-01',
            endDate: '2035-12-31',
            minDate: '2023-01-01',
            maxDate: '2035-12-31'
          })
        })
        /* var assignment_table_data = {{ assignment_table_data | tojson | safe }};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        console.log('Assignment data:', assignment_table_data)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        */
      </script>

      <script src="https://cdn.jsdelivr.net/npm/brython@3.9.1/brython.min.js"></script>
      <footer>
        <tr>
          <td style="background-color:#287429;" width="100%">
            <table cellspacing="0" cellpadding="0" border="0" width="800">
              <tbody>
                <tr>
                  <td width="100%" height="30" align="center" valign="center" style="font-size:10px;">
                    © 2023 SLT-Technologies GmbH &amp; Co. KG • Telefon +49 (421) 66 05 8-0 • Fax +49 (421) 66 05 8-40 • Email
                    <a href="mailto:info@slt-technologies.com">info@slt-technologies.com</a>
                  </td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>
      </footer>
    </body>
  {% endblock %}

  <!-- Jan Knijnenburg -->
</html>
